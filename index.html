<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†ã‚¢ãƒ—ãƒªğŸ¹</title>
    
    <!-- ã‚¢ã‚¤ã‚³ãƒ³è¨­å®š -->
    <link rel="icon" href="hamster-icon.png" type="image/png">
    <link rel="apple-touch-icon" href="hamster-icon.png">
    
    <!-- PWAè¨­å®š -->
    <meta name="theme-color" content="#f97316">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†ğŸ¹">
    
    <!-- Open Graphè¨­å®š -->
    <meta property="og:title" content="ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†ã‚¢ãƒ—ãƒªğŸ¹">
    <meta property="og:description" content="å¤§åˆ‡ãªãƒãƒ ã‚¹ã‚¿ãƒ¼ã®å¥åº·ã‚’è¨˜éŒ²ãƒ»ç®¡ç†ã™ã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚ä½“é‡ã€é£Ÿäº‹ã€å¥åº·ãƒã‚§ãƒƒã‚¯ã€é€šé™¢è¨˜éŒ²ãªã©ã‚’ç®¡ç†ã§ãã¾ã™ã€‚">
    <meta property="og:image" content="hamster-icon.png">
    <meta property="og:type" content="website">
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.8.0/recharts.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Meiryo', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const HamsterHealthApp = () => {
            const [showApp, setShowApp] = useState(false);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [selectedHamster, setSelectedHamster] = useState(1);
            const [showAddHamster, setShowAddHamster] = useState(false);
            const [showEditHamster, setShowEditHamster] = useState(false);
            const [showWeightChart, setShowWeightChart] = useState(false);
            const [editingWeightId, setEditingWeightId] = useState(null);
            const [editingWeight, setEditingWeight] = useState({ weight: '', date: '' });
            
            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
            const loadFromStorage = (key, defaultValue) => {
                try {
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : defaultValue;
                } catch (error) {
                    console.error(`Error loading ${key}:`, error);
                    return defaultValue;
                }
            };

            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            const saveToStorage = (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch (error) {
                    console.error(`Error saving ${key}:`, error);
                }
            };

            const [hamsters, setHamsters] = useState(() => 
                loadFromStorage('hamsters', [
                    { 
                        id: 1, 
                        name: 'ã‚‚ã¡ã‚‚ã¡', 
                        breed: 'ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³', 
                        color: 'ãƒãƒ¼ãƒãƒ«',
                        gender: 'ä¸æ˜',
                        genetics: 'ä¸æ˜',
                        birthDate: '2024-11-03',
                        birthDateType: 'exact',
                        adoptDate: '2024-11-10',
                        adoptDateType: 'exact',
                        photo: null
                    }
                ])
            );

            const [weightRecords, setWeightRecords] = useState(() =>
                loadFromStorage('weightRecords', [
                    { id: 1, hamsterId: 1, date: '2025-07-01', weight: 85.2 },
                    { id: 2, hamsterId: 1, date: '2025-06-24', weight: 83.5 },
                    { id: 3, hamsterId: 1, date: '2025-06-17', weight: 82.1 },
                    { id: 4, hamsterId: 1, date: '2025-06-10', weight: 80.8 },
                    { id: 5, hamsterId: 1, date: '2025-06-03', weight: 78.3 }
                ])
            );

            const [foodRecords, setFoodRecords] = useState(() =>
                loadFromStorage('foodRecords', [
                    { id: 1, hamsterId: 1, date: '2025-07-03', food: 'ãƒšãƒ¬ãƒƒãƒˆ', amount: '5g' },
                    { id: 2, hamsterId: 1, date: '2025-07-03', food: 'ã²ã¾ã‚ã‚Šã®ç¨®', amount: '2ç²’' }
                ])
            );

            const [healthChecks, setHealthChecks] = useState(() =>
                loadFromStorage('healthChecks', [
                    { id: 1, hamsterId: 1, date: '2025-07-03', eyes: true, nose: true, teeth: true, fur: true, activity: true, appetite: true }
                ])
            );

            const [medicalRecords, setMedicalRecords] = useState(() =>
                loadFromStorage('medicalRecords', [
                    { id: 1, hamsterId: 1, date: '2025-06-15', hospital: 'ãƒšãƒƒãƒˆã‚¯ãƒªãƒ‹ãƒƒã‚¯', medicine: 'ãƒ“ã‚¿ãƒŸãƒ³å‰¤', symptoms: 'é£Ÿæ¬²ä½ä¸‹', cost: 3500 }
                ])
            );

            const [newWeight, setNewWeight] = useState('');
            const [newWeightDate, setNewWeightDate] = useState('');

            const MAX_HAMSTERS = 999;
            const currentHamster = hamsters.find(h => h.id === selectedHamster);
            const currentDate = new Date().toISOString().split('T')[0];

            // ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            useEffect(() => {
                saveToStorage('hamsters', hamsters);
            }, [hamsters]);

            useEffect(() => {
                saveToStorage('weightRecords', weightRecords);
            }, [weightRecords]);

            useEffect(() => {
                saveToStorage('foodRecords', foodRecords);
            }, [foodRecords]);

            useEffect(() => {
                saveToStorage('healthChecks', healthChecks);
            }, [healthChecks]);

            useEffect(() => {
                saveToStorage('medicalRecords', medicalRecords);
            }, [medicalRecords]);

            const calculateAge = (birthDate, birthDateType) => {
                if (birthDateType === 'unknown') return 'ä¸æ˜';
                
                const birth = new Date(birthDate);
                const today = new Date();
                const diffTime = Math.abs(today - birth);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                const months = Math.floor(diffDays / 30);
                
                if (birthDateType === 'year') return `ç´„${months}ãƒ¶æœˆ`;
                if (birthDateType === 'yearMonth') return `ç´„${months}ãƒ¶æœˆ`;
                return `${months}ãƒ¶æœˆ`;
            };

            const getCurrentWeight = () => {
                const hamsterWeights = weightRecords.filter(r => r.hamsterId === selectedHamster);
                if (hamsterWeights.length === 0) return 0;
                return hamsterWeights.sort((a, b) => new Date(b.date) - new Date(a.date))[0].weight;
            };

            const getPeakWeight = () => {
                const hamsterWeights = weightRecords.filter(r => r.hamsterId === selectedHamster);
                if (hamsterWeights.length === 0) return 0;
                return Math.max(...hamsterWeights.map(r => r.weight));
            };

            const getWeightTrend = () => {
                const hamsterWeights = weightRecords.filter(r => r.hamsterId === selectedHamster).sort((a, b) => new Date(b.date) - new Date(a.date));
                if (hamsterWeights.length < 2) return 'stable';
                const latest = hamsterWeights[0].weight;
                const previous = hamsterWeights[1].weight;
                if (latest > previous) return 'up';
                if (latest < previous) return 'down';
                return 'stable';
            };

            const addWeightRecord = () => {
                if (newWeight) {
                    const record = {
                        id: Date.now(),
                        hamsterId: selectedHamster,
                        date: newWeightDate || currentDate,
                        weight: parseFloat(newWeight)
                    };
                    setWeightRecords([record, ...weightRecords]);
                    setNewWeight('');
                    setNewWeightDate('');
                }
            };

            const TabButton = ({ id, icon, label, active, onClick }) => (
                <button
                    onClick={() => onClick(id)}
                    className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${
                        active ? 'bg-orange-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                    }`}
                >
                    <span className="text-lg">{icon}</span>
                    <span className="text-sm">{label}</span>
                </button>
            );

            // ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
            if (!showApp) {
                return (
                    <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-orange-50 to-yellow-50 min-h-screen">
                        <div className="bg-white rounded-2xl shadow-lg p-6 mb-6">
                            <div className="flex items-center gap-3 mb-6">
                                <div className="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center">
                                    <span className="text-white text-2xl">ğŸ¹</span>
                                </div>
                                <div>
                                    <h1 className="text-2xl font-bold text-gray-800">ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†ã‚¢ãƒ—ãƒªğŸ¹</h1>
                                    <p className="text-gray-600">ãƒ‡ãƒ¼ã‚¿ã¯ã“ã®ç«¯æœ«ã«å®‰å…¨ã«ä¿å­˜ã•ã‚Œã¾ã™</p>
                                </div>
                            </div>

                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">ğŸ¹</div>
                                <h2 className="text-2xl font-bold text-gray-800 mb-4">ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†ã‚¢ãƒ—ãƒª</h2>
                                <p className="text-gray-600 mb-8">
                                    å¤§åˆ‡ãªãƒãƒ ã‚¹ã‚¿ãƒ¼ã®å¥åº·ã‚’è¨˜éŒ²ãƒ»ç®¡ç†ã™ã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚<br />
                                    ä½“é‡ã€é£Ÿäº‹ã€å¥åº·ãƒã‚§ãƒƒã‚¯ã€é€šé™¢è¨˜éŒ²ãªã©ã‚’ç®¡ç†ã§ãã¾ã™ã€‚
                                </p>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto">
                                    <div className="bg-blue-50 p-6 rounded-lg">
                                        <div className="text-4xl mb-4">ğŸ“Š</div>
                                        <h3 className="font-bold text-blue-800 mb-2">å¥åº·ç®¡ç†</h3>
                                        <p className="text-blue-600 text-sm">ä½“é‡å¤‰åŒ–ã‚’ã‚°ãƒ©ãƒ•ã§ç¢ºèª</p>
                                    </div>
                                    <div className="bg-green-50 p-6 rounded-lg">
                                        <div className="text-4xl mb-4">â¤ï¸</div>
                                        <h3 className="font-bold text-green-800 mb-2">è¤‡æ•°åŒ¹å¯¾å¿œ</h3>
                                        <p className="text-green-600 text-sm">æœ€å¤§999åŒ¹ã¾ã§ç®¡ç†å¯èƒ½</p>
                                    </div>
                                    <div className="bg-purple-50 p-6 rounded-lg">
                                        <div className="text-4xl mb-4">ğŸ¥</div>
                                        <h3 className="font-bold text-purple-800 mb-2">é€šé™¢è¨˜éŒ²</h3>
                                        <p className="text-purple-600 text-sm">ç—…é™¢ã®è¨˜éŒ²ã‚‚ç®¡ç†</p>
                                    </div>
                                    <div className="bg-orange-50 p-6 rounded-lg">
                                        <div className="text-4xl mb-4">ğŸ’¾</div>
                                        <h3 className="font-bold text-orange-800 mb-2">ãƒ‡ãƒ¼ã‚¿ä¿è­·</h3>
                                        <p className="text-orange-600 text-sm">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä»˜ã</p>
                                    </div>
                                </div>
                                
                                <div className="mt-8">
                                    <button 
                                        onClick={() => setShowApp(true)}
                                        className="bg-orange-500 hover:bg-orange-600 text-white px-8 py-3 rounded-lg font-semibold transition-colors"
                                    >
                                        ã‚¢ãƒ—ãƒªã‚’é–‹å§‹ã™ã‚‹
                                    </button>
                                </div>
                            </div>

                            <div className="text-center">
                                <p className="text-sm text-gray-500">
                                    â€» ã“ã®ã‚¢ãƒ—ãƒªã¯å®Œå…¨ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ä½œã—ã€ãƒ‡ãƒ¼ã‚¿ã¯ãŠä½¿ã„ã®ç«¯æœ«ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª
            return (
                <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-orange-50 to-yellow-50 min-h-screen">
                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <div className="flex items-center gap-3 mb-6">
                            <div className="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center">
                                <span className="text-white text-2xl">ğŸ¹</span>
                            </div>
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800">ãƒãƒ ã‚¹ã‚¿ãƒ¼å¥åº·ç®¡ç†</h1>
                                <p className="text-gray-600">ã¿ã‚“ãªã®å¥åº·ã‚’ã‚µãƒãƒ¼ãƒˆï¼ˆç™»éŒ²æ•°: {hamsters.length}åŒ¹ / æœ€å¤§{MAX_HAMSTERS}åŒ¹ç™»éŒ²å¯èƒ½ï¼‰</p>
                                <div className="flex items-center gap-4 mt-2">
                                    <p className="text-xs text-green-600">âœ… ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚æ¶ˆãˆã¾ã›ã‚“ï¼‰</p>
                                </div>
                            </div>
                        </div>

                        <div className="flex gap-2 mb-6 overflow-x-auto">
                            <TabButton
                                id="dashboard"
                                icon="ğŸ“Š"
                                label="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"
                                active={activeTab === 'dashboard'}
                                onClick={setActiveTab}
                            />
                            <TabButton
                                id="weight"
                                icon="âš–ï¸"
                                label="ä½“é‡è¨˜éŒ²"
                                active={activeTab === 'weight'}
                                onClick={setActiveTab}
                            />
                            <TabButton
                                id="food"
                                icon="ğŸ½ï¸"
                                label="é£Ÿäº‹è¨˜éŒ²"
                                active={activeTab === 'food'}
                                onClick={setActiveTab}
                            />
                            <TabButton
                                id="health"
                                icon="â¤ï¸"
                                label="å¥åº·ãƒã‚§ãƒƒã‚¯"
                                active={activeTab === 'health'}
                                onClick={setActiveTab}
                            />
                            <TabButton
                                id="medical"
                                icon="ğŸ¥"
                                label="é€šé™¢è¨˜éŒ²"
                                active={activeTab === 'medical'}
                                onClick={setActiveTab}
                            />
                        </div>

                        {activeTab === 'dashboard' && currentHamster && (
                            <div className="space-y-6">
                                <div className="bg-gradient-to-r from-orange-400 to-orange-500 text-white p-6 rounded-xl">
                                    <div className="flex items-start gap-4">
                                        <div className="flex-1">
                                            <h2 className="text-xl font-semibold mb-2">{currentHamster.name}</h2>
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <p className="text-orange-100">å“ç¨®: {currentHamster.breed}</p>
                                                    <p className="text-orange-100">æ¯›è‰²: {currentHamster.color}</p>
                                                    <p className="text-orange-100">æ€§åˆ¥: {currentHamster.gender}</p>
                                                    <p className="text-orange-100">éºä¼å­å‹: {currentHamster.genetics}</p>
                                                    <p className="text-orange-100">æœˆé½¢: {calculateAge(currentHamster.birthDate, currentHamster.birthDateType)}</p>
                                                </div>
                                                <div>
                                                    <p className="text-orange-100">ç¾åœ¨ã®ä½“é‡: {getCurrentWeight()}g</p>
                                                    <p className="text-orange-100">
                                                        ä½“é‡å¤‰åŒ–: {getWeightTrend() === 'up' ? 'â†—ï¸ å¢—åŠ ' : getWeightTrend() === 'down' ? 'â†˜ï¸ æ¸›å°‘' : 'â¡ï¸ å®‰å®š'}
                                                        ï¼ˆãƒ”ãƒ¼ã‚¯ä½“é‡ {getPeakWeight()}gï¼‰
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div className="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                                        <h3 className="font-semibold text-green-800 mb-2">å¥åº·ã‚¹ã‚³ã‚¢</h3>
                                        <div className="text-2xl font-bold text-green-600">100%</div>
                                    </div>
                                    <div className="bg-blue-50 p-4 rounded-lg border-2 border-blue-200">
                                        <h3 className="font-semibold text-blue-800 mb-2">ä½“é‡è¨˜éŒ²</h3>
                                        <div className="text-2xl font-bold text-blue-600">{weightRecords.filter(r => r.hamsterId === selectedHamster).length}å›</div>
                                    </div>
                                    <div className="bg-purple-50 p-4 rounded-lg border-2 border-purple-200">
                                        <h3 className="font-semibold text-purple-800 mb-2">é£Ÿäº‹è¨˜éŒ²</h3>
                                        <div className="text-2xl font-bold text-purple-600">{foodRecords.filter(r => r.hamsterId === selectedHamster).length}å›</div>
                                    </div>
                                </div>

                                <div className="bg-gray-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-3">æœ€è¿‘ã®è¨˜éŒ²</h3>
                                    <div className="space-y-2">
                                        {weightRecords
                                            .filter(r => r.hamsterId === selectedHamster)
                                            .sort((a, b) => new Date(b.date) - new Date(a.date))
                                            .slice(0, 3)
                                            .map(record => (
                                                <div key={record.id} className="flex justify-between items-center py-2 border-b border-gray-200">
                                                    <span>{record.date}</span>
                                                    <span className="font-medium">{record.weight}g</span>
                                                </div>
                                            ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'weight' && (
                            <div className="space-y-6">
                                <div className="bg-blue-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-3">ä½“é‡ã‚’è¨˜éŒ²ã™ã‚‹</h3>
                                    <div className="flex gap-3 mb-3">
                                        <input
                                            type="number"
                                            step="0.1"
                                            placeholder="ä½“é‡ï¼ˆgï¼‰"
                                            value={newWeight}
                                            onChange={(e) => setNewWeight(e.target.value)}
                                            className="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                        <input
                                            type="date"
                                            value={newWeightDate}
                                            onChange={(e) => setNewWeightDate(e.target.value)}
                                            className="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                        <button
                                            onClick={addWeightRecord}
                                            className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                                        >
                                            è¨˜éŒ²
                                        </button>
                                    </div>
                                    <p className="text-sm text-gray-600">æ—¥ä»˜ã‚’æŒ‡å®šã—ãªã„å ´åˆã¯ä»Šæ—¥ã®æ—¥ä»˜ãŒä½¿ç”¨ã•ã‚Œã¾ã™</p>
                                </div>

                                <div className="space-y-3">
                                    <h3 className="font-semibold">ä½“é‡å±¥æ­´</h3>
                                    {weightRecords
                                        .filter(r => r.hamsterId === selectedHamster)
                                        .sort((a, b) => new Date(b.date) - new Date(a.date))
                                        .map(record => (
                                            <div key={record.id} className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <span className="font-medium">{record.weight}g</span>
                                                    <span className="text-gray-600 ml-3">{record.date}</span>
                                                </div>
                                            </div>
                                        ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'food' && (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">ğŸ½ï¸</div>
                                <h3 className="text-xl font-bold text-gray-800 mb-2">é£Ÿäº‹è¨˜éŒ²</h3>
                                <p className="text-gray-600">ã“ã®æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™</p>
                            </div>
                        )}

                        {activeTab === 'health' && (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">â¤ï¸</div>
                                <h3 className="text-xl font-bold text-gray-800 mb-2">å¥åº·ãƒã‚§ãƒƒã‚¯</h3>
                                <p className="text-gray-600">ã“ã®æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™</p>
                            </div>
                        )}

                        {activeTab === 'medical' && (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">ğŸ¥</div>
                                <h3 className="text-xl font-bold text-gray-800 mb-2">é€šé™¢è¨˜éŒ²</h3>
                                <p className="text-gray-600">ã“ã®æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<HamsterHealthApp />, document.getElementById('root'));
    </script>
</body>
</html>